<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <title>Affordable Housing Statistics in Conneticut for 2011-2016</title>
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootswatch@4.5.2/dist/sandstone/bootstrap.min.css" 
  integrity="sha384-zEpdAL7W11eTKeoBJK1g79kgl9qjP7g84KfK3AZsuonx38n8ad+f5ZgXtoSDxPOh" crossorigin="anonymous">
  <style>
    #map {
      width: 100%;
      height: calc(40vh);
    }

    #about {
      max-height: calc(80vh);
      overflow-y: scroll;
    }

    .counties {
  fill: #61aab6;
  stroke: whitesmoke;
  stroke-width: .7;
}

#ui-controls {
    width: 176px;
    padding: 8px 25px 8px 15px;
    background: rgba(75, 75, 75, 0.8);
    box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
    border-radius: 5px;
    color: whitesmoke;
}

#ui-controls .min {
    float: left;
}

#ui-controls .max {
    float: right;
    margin-right: -15px;
}

.year-slider {
    width: 100%;
}

label {
    font-size: 1.1em;
    font-weight: bold;
}

    /* Small devices (landscape phones, 576px and up) */
    @media (min-width: 576px) {}

    /* Medium devices (tablets, 768px and up) */
    @media (min-width: 768px) {
      #map {
        height: calc(60vh);
      }
    }

    /* Large devices (desktops, 992px and up) */
    @media (min-width: 992px) {

      #map {
        height: calc(80vh);
      }
    }

    /* Extra large devices (large desktops, 1200px and up) */
    @media (min-width: 1200px) {}
  </style>

</head>

<body>

  <div class="container-fluid">
    <header class="row py-3 bg-dark text-white">
      <div class="col mx-2">
        <h1 class="h1">Affordable Housing in Conneticut</h1>
      </div>
    </header>

    <section class="row bg-secondary ">
      <div class="col-12 col-md-7 col-lg-8 px-0">
        <div id="map" class="bg-light position-relative"></div>
      </div>
      <aside id="about" class="col-12 col-md-5 col-lg-4 text-dark py-2">
        <section>
          <h2 class="h2 text-dark">About this map</h2>
          <p>A fan brush is a fantastic piece of equipment. Use it. Make friends with it. We're not trying to teach you
            a thing to copy. We're just here to teach you a technique, then let you loose into the world. We'll put a
            happy little sky in here.</p>
          <p>We'll paint one happy little tree right here. The secret to doing anything is believing that you can do it.
            Anything that you believe you can do strong enough, you can do. Anything. As long as you believe. Let's make
            a nice big leafy tree.</p>
          <p>Lorem Ipsum by <a href="https://www.bobrosslipsum.com/index.html">Bob Ross quotes generator</a>.</p>
          <p>Everything's not great in life, but we can still find beauty in it. I'll go over the colors one more time that we use: Titanium white, Thalo green, Prussian blue, Van Dyke brown, Alizarin crimson, Sap green, Cad yellow, and Permanent red. Only think about one thing at a time. Don't get greedy. In painting, you have unlimited power. You have the ability to move mountains. You can bend rivers. But when I get home, the only thing I have power over is the garbage. I get carried away with this brush cleaning.</p>
        </section>
      </aside>
    </section>
    <footer class="row bg-dark text-white py-3">
      <div class="col mx-2">
        <ul class="list-unstyled">
          <li>jrwi242 or Joyia Williams</li>
          <li>December 12, 2021</li>
          <li><a href="https://catalog.data.gov/dataset/affordable-housing-by-town-2011-present">meta data</a></li>
        </ul>
      </div>

      <div id="map"></div>
<div id="ui-controls">
    <input type="range" min="2011" max="2016"
           value="2011" step="1" class="year-slider">
    </input>
</div>
    </footer>
  </div> <!-- end .container-fluid -->


  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
    integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous">
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
    integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous">
  </script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
    integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous">
  </script>

  <script src="https://d3js.org/d3.v5.js"></script>
  <script src="https://unpkg.com/topojson@3"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/chroma-js/2.1.2/chroma.min.js"
    integrity="sha512-8TVPS0EFkkmtT6yPb5K4csnSt3tjbKRrs0F8gvTNKv2OxOcwDO7+Klkz86gMVrzfqtZos5N2a+k+r9D+hlccmQ=="
    crossorigin="anonymous" 
    referrerpolicy="no-referrer">
</script>

  <script>

// asynchronous calls to data files
const stateJson = d3.json('data/cb_2018_09_bg_500k.json');
const ahCSV = d3.csv('data/Affordable_Housing.csv');

// use promise to call all data files, then send data to callback
Promise.all([stateJson, ahCSV])
  .then(drawMap)
  .catch(error => {
    console.log(error)
  });

  // function called when Promise above is complete
function drawMap(data) {
  
  console.log(data);  // our two datasets within an array

  // data is array of our two datasets
  const stateData = data[0];
  const housingData = data[1];
// select the HTML element that will hold our map
const mapContainer = d3.select('#map')

// determine width and height of map from container
const width = mapContainer.node().offsetWidth - 60;
const height = mapContainer.node().offsetHeight - 60;

const svg = mapContainer
  .append('svg')
  .attr('width', width)
  .attr('height', height)
  .classed('position-absolute', true) // add bootstrap class
  .style('top', 40)
  .style('left', 40);

  const geojson = topojson.feature(stateData, {
  type: 'GeometryCollection',
  geometries: stateData.objects.cb_2018_09_bg_500k.geometries
});

const projection = d3.geoAlbersUsa()
  .fitSize([width, height], geojson);

const path = d3.geoPath()
  .projection(projection)

const Conn = svg.append('g')
  .selectAll('path')
  .data(geojson.features)
  .join('path')
  .attr('d', path)
  .attr('class', 'counties');
} // end drawMap()

function updateMap() {

} // end updateMap()

function drawLegend() {

  // select div and create legend title
const legend = document.querySelector('.legend')
legend.innerHTML = "<h3><span>2011</span> Affordable Housing</h3><ul>";

// loop through the break values
for (let i = 0; i < breaks.length - 1; i++) {
    
    // determine color value 
    const color = colorize(breaks[i], breaks);

    // create legend item
    const classRange = `<li><span style="background:${color}"></span>
        ${breaks[i].toLocaleString()}% &mdash;
        ${breaks[i + 1].toLocaleString()}$ </li>`

    // append to legend unordered list item
    legend.innerHTML += classRange;
}
// close legend unordered list
legend.innerHTML += "</ul>";

// create a Leaflet control for the legend
const legendControl = L.control({
    position: 'topright'
});

// when the control is added to the map
legendControl.onAdd = function (map) {

    // create a new division element with class of 'legend' and return
    const legend = L.DomUtil.create('div', 'legend');
    return legend;

};

// add the legend control to the map
legendControl.addTo(map);

// define color generator
const color = d3.scaleOrdinal(d3.schemeDark2);

} // end drawLegend

function createSliderUI() {

  // create Leaflet control for the slider
const sliderControl = L.control({ position: 'topleft'} );

// when added to the map
sliderControl.onAdd = function(map) {

    // select an existing DOM element with an id of "ui-controls"
    const slider = L.DomUtil.get("ui-controls");

    // disable scrolling of map while using controls
    L.DomEvent.disableScrollPropagation(slider);

    // disable click events while using controls
    L.DomEvent.disableClickPropagation(slider);

    // return the slider from the onAdd method
    return slider;
}

// add the control to the map
sliderControl.addTo(map);

}

  </script>
</body>

</html>
